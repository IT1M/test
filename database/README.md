# دليل قاعدة البيانات - نظام مخزون مايس السعودية

## نظرة عامة
هذا المجلد يحتوي على جميع ملفات SQL اللازمة لإعداد وإدارة قاعدة البيانات لنظام مخزون مايس السعودية.

## الملفات المتاحة

### 1. الإعداد الأساسي
- **`basic-setup.sql`** - الإعدادات الأساسية والضرورية لقاعدة البيانات
- **`setup-rls-and-security.sql`** - تفعيل Row Level Security والإعدادات الأمنية الشاملة

### 2. البيانات والاختبار
- **`sample-data.sql`** - بيانات تجريبية لاختبار النظام
- **`daily-queries.sql`** - استعلامات يومية أساسية للاستخدام العادي

### 3. الإدارة والمراقبة
- **`admin-queries.sql`** - استعلامات إدارية متقدمة للمراقبة والتحليل
- **`performance-optimization.sql`** - تحسين الأداء والفهارس المتقدمة

## ترتيب التنفيذ المقترح

### المرحلة الأولى: الإعداد الأساسي
```sql
-- 1. تشغيل الإعداد الأساسي أولاً
\i basic-setup.sql
```

### المرحلة الثانية: الأمان
```sql
-- 2. تفعيل الأمان و RLS
\i setup-rls-and-security.sql
```

### المرحلة الثالثة: البيانات التجريبية (اختياري)
```sql
-- 3. إضافة بيانات تجريبية للاختبار
\i sample-data.sql
```

### المرحلة الرابعة: تحسين الأداء (اختياري)
```sql
-- 4. تطبيق تحسينات الأداء
\i performance-optimization.sql
```

## كيفية الاستخدام في Neon Console

### الطريقة الأولى: نسخ ولصق مباشر
1. افتح Neon Console
2. اذهب إلى SQL Editor
3. انسخ محتوى الملف المطلوب
4. الصق في SQL Editor
5. اضغط Run

### الطريقة الثانية: تنفيذ تدريجي
1. انسخ أقسام صغيرة من الملف
2. شغل كل قسم على حدة
3. تأكد من عدم وجود أخطاء قبل المتابعة

## الملفات حسب الاستخدام

### للمطورين الجدد
ابدأ بهذا الترتيب:
1. `basic-setup.sql` - الأساسيات
2. `daily-queries.sql` - الاستعلامات اليومية
3. `sample-data.sql` - بيانات للتجريب

### للمديرين
استخدم هذه الملفات:
1. `admin-queries.sql` - مراقبة النظام
2. `performance-optimization.sql` - تحسين الأداء
3. `setup-rls-and-security.sql` - الأمان المتقدم

### للإنتاج
الترتيب الموصى به:
1. `basic-setup.sql`
2. `setup-rls-and-security.sql`
3. `performance-optimization.sql`

## نصائح مهمة

### قبل التنفيذ
- ✅ تأكد من وجود نسخة احتياطية
- ✅ اقرأ الملف كاملاً قبل التنفيذ
- ✅ غير كلمات المرور الافتراضية
- ✅ راجع الإعدادات حسب بيئتك

### أثناء التنفيذ
- ⚠️ شغل الملفات بالترتيب المحدد
- ⚠️ تحقق من عدم وجود أخطاء بعد كل ملف
- ⚠️ لا تشغل ملفات الاختبار في الإنتاج

### بعد التنفيذ
- 🔍 تحقق من إنشاء الجداول والفهارس
- 🔍 اختبر الاتصال بقاعدة البيانات
- 🔍 تأكد من عمل RLS بشكل صحيح

## استكشاف الأخطاء

### مشاكل شائعة وحلولها

#### خطأ في الصلاحيات
```sql
-- إذا ظهر خطأ في الصلاحيات، شغل هذا:
GRANT ALL PRIVILEGES ON DATABASE postgres TO your_username;
```

#### خطأ في الامتدادات
```sql
-- إذا لم تعمل الامتدادات:
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";
CREATE EXTENSION IF NOT EXISTS "pgcrypto";
```

#### خطأ في RLS
```sql
-- للتحقق من حالة RLS:
SELECT tablename, rowsecurity 
FROM pg_tables 
WHERE schemaname = 'public';
```

## معلومات الاتصال

### بيانات الاتصال الافتراضية
- **المستخدم الافتراضي:** admin@mais.sa
- **كلمة المرور الافتراضية:** Admin123!@# (يجب تغييرها فوراً!)
- **المنطقة الزمنية:** Asia/Riyadh

### أدوار قاعدة البيانات
- `mais_admin` - مدير كامل
- `mais_app` - للتطبيق
- `mais_readonly` - قراءة فقط

## الدعم والمساعدة

إذا واجهت مشاكل:
1. تحقق من سجلات الأخطاء
2. راجع قسم استكشاف الأخطاء أعلاه
3. تأكد من تطبيق الملفات بالترتيب الصحيح

## ملاحظات الأمان

⚠️ **تحذيرات مهمة:**
- غير جميع كلمات المرور الافتراضية
- لا تستخدم البيانات التجريبية في الإنتاج
- فعل SSL في بيئة الإنتاج
- راقب سجلات الأمان بانتظام

✅ **أفضل الممارسات:**
- أنشئ نسخ احتياطية منتظمة
- راقب أداء قاعدة البيانات
- حدث الإحصائيات بانتظام
- نظف البيانات القديمة

---

**تم إنشاؤه لنظام مخزون مايس السعودية**  
**تاريخ آخر تحديث:** يناير 2024